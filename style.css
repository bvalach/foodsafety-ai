/* Fonts */
@import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@500;600;700;800&family=Raleway:wght@300;400;500;600&display=swap');

/* Design tokens - Refined palette */
:root{
  --bg: #fafbfc;
  --bg-2:#ffffff;
  --bg-glass: rgba(255, 255, 255, 0.98);
  --text:#0f172a;
  --text-secondary:#475569;
  --muted:#64748b;
  --accent:#1e40af;
  --accent-2:#3b82f6;
  --accent-3:#60a5fa;
  --accent-light:#dbeafe;
  --accent-gradient: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
  --border:#e2e8f0;
  --border-light:#f1f5f9;
  --radius:12px;
  --radius-sm:8px;
  --radius-lg:20px;
  --shadow-sm:0 1px 3px rgba(0,0,0,.04);
  --shadow-md:0 4px 16px rgba(30, 64, 175, .08);
  --shadow-lg:0 8px 24px rgba(30, 64, 175, .12);
  --shadow-float:0 12px 32px rgba(30, 64, 175, .16);
  --space-1:.25rem;
  --space-2:.5rem;
  --space-3:.75rem;
  --space-4:1rem;
  --space-5:1.5rem;
  --space-6:2rem;
  --space-7:2.5rem;
  --transition: all .2s cubic-bezier(.4, 0, .2, 1);
  --transition-fast: all .12s cubic-bezier(.4, 0, .2, 1);
}

/* Global */
*{box-sizing:border-box}
html,body{height:100%; scroll-behavior:smooth}
body{
  margin:0;
  font-family:'Raleway', system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  color:var(--text);
  background:linear-gradient(180deg, var(--bg), #f1f5f9 350px);
  line-height:1.6;
  -webkit-font-smoothing:antialiased;
  text-rendering:optimizeLegibility;
  overflow-x:hidden
}

h1,h2,h3{font-family:'Montserrat', sans-serif; margin:0 0 var(--space-4) 0; color:var(--text)}
h1{font-weight:800; font-size:clamp(2rem, 4vw, 3rem); letter-spacing:-.04em}
h2{font-weight:700; font-size:clamp(1.2rem, 2.5vw, 1.5rem); letter-spacing:-.02em}
h3{font-weight:700; font-size:1.1rem; letter-spacing:-.01em}

header{
  background: var(--accent-gradient);
  color:#fff;
  padding: clamp(2rem, 5vw, 3rem) 1rem;
  text-align:center;
  position:relative;
  box-shadow:var(--shadow-lg);
}
header h1{
  font-weight:800;
  text-shadow: 0 2px 12px rgba(0,0,0,.2);
  letter-spacing:-.03em;
  margin-bottom: var(--space-3);
  position:relative;
  z-index:1;
}
header h2{
  font-weight:600;
  color: rgba(255,255,255,.95);
  margin-bottom: var(--space-5);
  position:relative;
  z-index:1;
}
header .loading-notice{
  max-width:900px;
  margin:0 auto;
  background: rgba(255, 255, 255, .12);
  backdrop-filter: blur(8px);
  border:1px solid rgba(255,255,255,.2);
  border-radius:var(--radius-sm);
  padding:1rem 1.2rem;
  font-size:.95rem;
  line-height:1.6;
  position:relative;
  z-index:1;
}

.acknowledgement{
  max-width:720px;
  margin: var(--space-4) auto 0 auto;
  padding: 1rem 1.2rem;
  border-radius:var(--radius-sm);
  background: rgba(255,255,255,.12);
  backdrop-filter: blur(8px);
  border:1px solid rgba(255,255,255,.25);
}
.acknowledgement strong{color:#e0e7ff; font-weight:600}

/* Containers */
main,
.timeline-container,
.category-filters-container,
.source-filters-container,
.data-persistence-container,
.results-summary{
  max-width:1200px;
  margin: 0 auto;
}

.timeline-container,
.category-filters-container,
.source-filters-container,
.data-persistence-container{
  margin: var(--space-6) auto;
  background:var(--bg-2);
  border:1px solid var(--border);
  border-radius:var(--radius);
  box-shadow:var(--shadow-sm);
  padding: var(--space-6) var(--space-5);
  transition: var(--transition);
}
.timeline-container:hover,
.category-filters-container:hover,
.source-filters-container:hover,
.data-persistence-container:hover{
  box-shadow:var(--shadow-md);
  border-color: var(--accent-light);
}

/* Results summary */
.results-summary{
  margin: var(--space-6) auto;
  display:flex; align-items:center; justify-content:space-between;
  background:var(--bg-2);
  border:1px solid var(--border);
  border-radius: var(--radius);
  padding: var(--space-5);
  box-shadow:var(--shadow-sm);
}
.results-summary strong{
  font-size:1.25rem;
  color: var(--accent);
  font-weight:700;
}
.results-summary strong::before{
  content:"";
  display:inline-block;
  width:8px;
  height:8px;
  background: var(--accent-2);
  border-radius:50%;
  margin-right: var(--space-2);
  animation: pulse 2s ease-in-out infinite;
}
@keyframes pulse{
  0%, 100%{opacity:1; transform:scale(1)}
  50%{opacity:.6; transform:scale(1.2)}
}

/* Filters */
.category-filters, .source-filters{
  display:flex; flex-wrap:wrap; gap:.6rem; justify-content:center;
  margin-bottom: var(--space-5);
}
.category-filter-btn, .source-filter-btn, .filter-action-btn, .export-btn, #reset-timeline, #modal-link{
  border:1px solid var(--border);
  background:var(--bg-2);
  color:var(--text);
  padding:.5rem 1rem;
  border-radius: 999px;
  font: inherit;
  font-weight:600;
  font-size:.85rem;
  cursor:pointer;
  transition:var(--transition);
  box-shadow: 0 1px 2px rgba(0,0,0,.04);
}
.category-filter-btn:hover, .source-filter-btn:hover, .filter-action-btn:hover, .export-btn:hover, #reset-timeline:hover{
  transform:translateY(-1px);
  border-color: var(--accent-2);
  box-shadow: var(--shadow-sm);
}
.category-filter-btn.active, .source-filter-btn.active{
  background: var(--accent-gradient);
  color:#fff;
  border-color: transparent;
  box-shadow: 0 2px 8px rgba(30, 64, 175, .2);
}
.category-filter-btn.active:hover, .source-filter-btn.active:hover{
  transform:translateY(-1px);
  box-shadow: 0 4px 12px rgba(30, 64, 175, .3);
}
.filter-actions{display:flex; gap:.8rem; justify-content:center; margin-top: var(--space-3)}

/* Timeline */
.timeline-controls{display:flex; flex-direction:column; gap:1rem}
.timeline-labels{display:flex; justify-content:space-between; color:var(--muted); font-weight:700; font-size:.95rem; letter-spacing:-.01em}
.timeline-slider{position:relative; height:44px}
.timeline-slider::before{
  content:"";
  position:absolute;
  top:50%; left:0; right:0;
  transform:translateY(-50%);
  height:10px;
  background: linear-gradient(90deg, var(--border-light), #cbd5e1);
  border-radius:10px;
  z-index:0
}
.timeline-slider input[type=range]{
  position:absolute; width:100%; height:10px; background:transparent; appearance:none; pointer-events:none; z-index:2;
}
.timeline-slider input[type=range]::-webkit-slider-track{
  height:10px; border-radius:10px; background:transparent;
}
.timeline-slider input[type=range]::-webkit-slider-thumb{
  appearance:none; -webkit-appearance:none;
  height:22px; width:22px; border-radius:50%;
  background: var(--accent-gradient);
  border:3px solid #fff;
  box-shadow: 0 2px 12px rgba(37, 99, 235, .4), 0 0 0 4px rgba(37, 99, 235, .1);
  cursor:pointer; pointer-events:all;
  transition: var(--transition-fast);
  margin-top:-6px
}
.timeline-slider input[type=range]::-webkit-slider-thumb:hover{
  transform:scale(1.1);
  box-shadow: 0 4px 16px rgba(37, 99, 235, .5), 0 0 0 6px rgba(37, 99, 235, .15);
}
.timeline-selected{
  display:flex; align-items:center; justify-content:center; gap: var(--space-3);
  font-size:.95rem;
  font-weight:600;
  color:var(--text);
  background: linear-gradient(135deg, #f8fafc, #fff);
  padding: var(--space-3) var(--space-4);
  border-radius:var(--radius-sm);
  border:1px solid var(--border);
  box-shadow: 0 2px 8px rgba(0,0,0,.04);
}

/* Grid & cards */
main{padding: var(--space-6) var(--space-4)}
#paper-grid{
  display:grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: var(--space-5);
}
.paper-card{
  background:var(--bg-2);
  border:1px solid var(--border);
  border-radius:var(--radius);
  padding: var(--space-5);
  box-shadow:var(--shadow-sm);
  transition:var(--transition);
  position:relative;
  overflow:hidden;
  cursor:pointer;
}
.paper-card::before{
  content:"";
  position:absolute;
  top:0; left:0; right:0;
  height:2px;
  background: var(--accent-gradient);
  opacity:0;
  transition: opacity var(--transition-fast);
}
.paper-card:hover::before{opacity:1}
.paper-card:hover{transform:translateY(-4px); box-shadow:var(--shadow-md); border-color: var(--accent-light)}
.paper-card h3{
  font-size:1rem; font-weight:700; margin:0 0 var(--space-3) 0; line-height:1.5;
  display:-webkit-box; -webkit-box-orient:vertical; -webkit-line-clamp: 2; overflow:hidden;
  color:var(--text);
  transition: color var(--transition-fast);
}
.paper-card:hover h3{color: var(--accent)}
.paper-card .meta{
  display:flex; align-items:center; justify-content:space-between;
  color:var(--muted); font-size:.85rem; margin-bottom:var(--space-3);
  font-weight:500;
}
.paper-card .tags{display:flex; flex-wrap:wrap; gap:.4rem; margin-top:var(--space-3)}
.tag{
  font-size:.7rem; font-weight:600; padding:.2rem .6rem; border-radius:999px; 
  border:1px solid var(--border); background:var(--bg); color:var(--text-secondary);
  transition: var(--transition-fast);
}
.tag:hover{background: var(--accent-light); border-color: var(--accent-2); color: var(--accent)}
.tag.source[data-source="arXiv"]{
  background: #f8fafc;
  border-color: #cbd5e1;
  color:#475569
}
.tag.source[data-source="SemanticScholar"]{
  background: #eff6ff;
  border-color: #93c5fd;
  color:#1e40af
}
.tag.source[data-source="Crossref"]{
  background: #ecfeff;
  border-color: #67e8f9;
  color:#0e7490
}
.paper-doi{
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
  font-size:.75rem;
  color:var(--muted);
  word-break:break-all;
  margin-top:.6rem;
  padding: var(--space-2);
  background: linear-gradient(135deg, #f8fafc, #fff);
  border-radius: var(--radius-sm);
  border:1px solid var(--border-light)
}

/* Modal */
.modal{display:none; position:fixed; inset:0; background:rgba(15, 23, 42, .75); backdrop-filter: blur(4px); z-index:1000; animation: fadeIn .15s ease-out}
@keyframes fadeIn{from{opacity:0} to{opacity:1}}
.modal-content{
  background:#fff;
  border-radius:var(--radius-lg); width:min(800px, calc(100% - 2rem));
  margin: 6vh auto; padding: clamp(1.5rem, 4vw, 2.5rem); position:relative; 
  box-shadow:0 20px 60px rgba(15, 23, 42, .25);
  border:1px solid var(--border);
  animation: slideUp .2s ease-out
}
@keyframes slideUp{from{opacity:0; transform:translateY(16px)} to{opacity:1; transform:translateY(0)}}
.close-button{
  position:absolute; top:1rem; right:1rem; width:36px; height:36px; font-size:1.5rem;
  background:transparent; border:none; color:var(--muted);
  cursor:pointer; border-radius:50%; transition: var(--transition);
  display:flex; align-items:center; justify-content:center;
}
.close-button:hover{
  background: var(--bg); color: var(--text); transform: rotate(90deg);
}
.modal-content h2{
  font-size:1.4rem; color:var(--text); margin-top:.5rem; line-height:1.4;
  margin-bottom: var(--space-4); padding-bottom: var(--space-4); 
  border-bottom:1px solid var(--border); font-weight:700;
}
.modal-content p{font-size:.95rem; color:var(--text-secondary); line-height:1.7; margin-bottom: var(--space-3)}
#modal-authors{font-weight:600; color:var(--text); font-size:.9rem}
#modal-date{color:var(--muted); font-weight:500; font-size:.85rem}
#modal-abstract{color:var(--text-secondary); line-height:1.7; text-align:justify; font-size:.95rem}
#modal-doi{
  background: var(--bg);
  border:1px solid var(--border);
  border-radius:var(--radius-sm);
  padding:.8rem; text-align:center; margin-top: var(--space-4)
}
#modal-doi a{color:var(--accent); font-weight:700; text-decoration:none; transition: var(--transition); font-size:.9rem}
#modal-doi a:hover{color:var(--accent-2)}
#modal-link{
  display:inline-block; margin-top:var(--space-5); padding: .7rem 1.5rem; background:var(--accent-gradient);
  color:#fff; text-decoration:none; font-weight:700; border-radius:999px; font-size:.9rem;
  box-shadow: 0 2px 8px rgba(30, 64, 175, .2); transition: var(--transition)
}
#modal-link:hover{
  transform: translateY(-1px); box-shadow: 0 4px 12px rgba(30, 64, 175, .3)
}

/* Persistence */
.save-status{
  margin-left:.8rem;
  font-style:italic;
  font-weight:600;
  color:var(--accent);
  background: linear-gradient(135deg, #eff6ff, #dbeafe);
  padding:.4rem .9rem;
  border-radius:999px;
  border:1px solid var(--accent-3);
  box-shadow: 0 2px 8px rgba(37, 99, 235, .1)
}

/* Footer */
footer{
  margin-top: var(--space-7);
  background: var(--accent-gradient);
  color:#fff;
  text-align:center;
  padding: 2.5rem 1rem;
  position:relative;
  overflow:hidden;
  box-shadow: 0 -4px 20px rgba(37, 99, 235, .2)
}
footer::before{
  content:"";
  position:absolute;
  top:-100px; left:50%; transform:translateX(-50%);
  width:800px; height:400px;
  background: radial-gradient(ellipse, rgba(255,255,255,.1) 0%, transparent 70%);
  pointer-events:none
}
footer p{margin: var(--space-2) 0; font-weight:500}
footer a{color:#dbeafe; text-decoration:none; border-bottom:1px solid rgba(255,255,255,.3); transition: var(--transition); font-weight:600}
footer a:hover{
  color:#fff;
  border-bottom-color:#fff;
  text-shadow: 0 2px 8px rgba(0,0,0,.2)
}

/* Skeleton loader */
.skel{
  border-radius:var(--radius);
  border:1px solid var(--border);
  background:var(--bg-glass);
  padding: var(--space-5);
  position:relative;
  overflow:hidden;
  box-shadow:var(--shadow-sm)
}
.skel::before{
  content:"";
  position:absolute;
  top:0; left:0; right:0;
  height:3px;
  background: linear-gradient(90deg, var(--border-light), var(--accent-3), var(--border-light));
  background-size: 200% 100%;
  animation: shimmer 1.5s ease-in-out infinite
}
.skel .bar{
  height:12px; background: linear-gradient(90deg, #e2e8f0, #f1f5f9, #e2e8f0);
  border-radius:8px; margin:.6rem 0;
  background-size: 200% 100%;
  animation: shimmer 1.5s ease-in-out infinite
}
.skel .bar.title{height:20px; width:80%; margin-top:.8rem}
.skel .bar.meta{width:60%; margin-bottom:1rem}
.skel .bar.line{width:95%}
@keyframes shimmer{
  0%{background-position: 200% 0}
  100%{background-position: -200% 0}
}

/* A11y focus */
:focus-visible{outline: 3px solid #93c5fd; outline-offset:3px}

/* Reduced motion */
@media (prefers-reduced-motion: reduce){
  *{animation:none !important; transition:none !important}
}
